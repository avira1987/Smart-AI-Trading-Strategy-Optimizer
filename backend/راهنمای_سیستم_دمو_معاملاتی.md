# ุฑุงูููุง ุณุณุชู ุฏูู ูุนุงููุงุช ุจุง Twelve Data

ุงู ุณุณุชู ุงูฺฉุงู ูุนุงููุงุช ุฏูู ูุงูุน ุฑุง ุจุฑุง ฺฉุงุฑุจุฑุงู ฺฉู Windows ู MetaTrader 5 ูุฏุงุฑูุฏ ูุฑุงูู ูโฺฉูุฏ.

## ๐ ูฺฺฏโูุง

### โ ุฏุฑุงูุช ููุช ูุญุธูโุง ุงุฒ Twelve Data
- ุงุณุชูุงุฏู ุงุฒ API Twelve Data ุจุฑุง ุฏุฑุงูุช ููุชโูุง ูุงูุน ุทูุง
- ูพุดุชุจุงู ุงุฒ bid/ask ู ููุชโูุง ูุญุธูโุง
- Fallback ุจู API ูุง ุฏฺฏุฑ ุฏุฑ ุตูุฑุช ุนุฏู ุฏุณุชุฑุณ

### โ ุณุณุชู ูุนุงููุงุช ุฏูู
- ุจุงุฒ ฺฉุฑุฏู ูุนุงููุงุช Buy/Sell
- ูุฏุฑุช Stop Loss ู Take Profit
- ูุญุงุณุจู ุณูุฏ/ุฒุงู ูุญุธูโุง
- ูุฏุฑุช ูุงุฑุฌู ู ููุฌูุฏ

### โ ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ููุชโูุง
- ุจูโุฑูุฒุฑุณุงู ููุชโูุง ูุนุงููุงุช ุจุงุฒ ูุฑ 10 ุซุงูู
- ุจุฑุฑุณ ุฎูุฏฺฉุงุฑ Stop Loss ู Take Profit
- ุจุณุชู ุฎูุฏฺฉุงุฑ ูุนุงููุงุช ุฏุฑ ุตูุฑุช ูุนุงู ุดุฏู SL/TP

## ๐ ุฑุงูโุงูุฏุงุฒ

### 1. ุชูุธู API Key

ุฏุฑ ูุงู `.env` ุง environment variables ุงุถุงูู ฺฉูุฏ:

```bash
TWELVEDATA_API_KEY=your_api_key_here
```

ุจุฑุง ุฏุฑุงูุช API Key:
1. ุจู [Twelve Data](https://twelvedata.com/) ุจุฑูุฏ
2. ุซุจุชโูุงู ฺฉูุฏ
3. API Key ุฎูุฏ ุฑุง ุงุฒ dashboard ุฏุฑุงูุช ฺฉูุฏ

### 2. ุงุฌุฑุง Migration

```bash
cd backend
python manage.py makemigrations
python manage.py migrate
```

ุงู migration ูุฏูโูุง ุฒุฑ ุฑุง ุงุฌุงุฏ ูโฺฉูุฏ:
- `DemoAccount`: ุญุณุงุจ ุฏูู ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ
- `DemoTrade`: ูุนุงููุงุช ุฏูู
- ุจูโุฑูุฒุฑุณุงู `LiveTrade` ุจุฑุง ูพุดุชุจุงู ุงุฒ ูุนุงููุงุช ุฏูู

### 3. ุฑุงูโุงูุฏุงุฒ Celery Beat

ุจุฑุง ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ููุชโูุงุ Celery Beat ุจุงุฏ ุงุฌุฑุง ุดูุฏ:

```bash
# Windows
celery -A config beat --loglevel=info

# Linux/Mac
celery -A config beat --loglevel=info
```

Task `update_demo_trades_prices_task` ูุฑ 10 ุซุงูู ุงุฌุฑุง ูโุดูุฏ.

## ๐ก API Endpoints

### 1. ุฏุฑุงูุช ุงุทูุงุนุงุช ุญุณุงุจ ุฏูู

```http
GET /api/demo/account/
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "account": {
    "balance": 10000.0,
    "equity": 10000.0,
    "margin": 0.0,
    "free_margin": 10000.0,
    "profit": 0.0,
    "leverage": 100,
    "open_trades": 0,
    "is_active": true
  }
}
```

### 2. ุจุงุฒ ฺฉุฑุฏู ูุนุงููู ุฏูู

```http
POST /api/demo/trades/
Authorization: Bearer <token>
Content-Type: application/json

{
  "trade_type": "buy",
  "symbol": "XAU/USD",
  "volume": 0.01,
  "stop_loss": 2040.0,
  "take_profit": 2060.0,
  "strategy_id": 1  // ุงุฎุชุงุฑ
}
```

**Response:**
```json
{
  "success": true,
  "message": "ูุนุงููู ุจุง ููููุช ุจุงุฒ ุดุฏ",
  "trade": {
    "id": 1,
    "symbol": "XAU/USD",
    "trade_type": "buy",
    "volume": 0.01,
    "open_price": 2050.25,
    "current_price": 2050.25,
    "stop_loss": 2040.0,
    "take_profit": 2060.0,
    "commission": 0.07
  },
  "account": {
    "balance": 10000.0,
    "equity": 10000.0,
    "margin": 20.5,
    "free_margin": 9979.5
  }
}
```

### 3. ุฏุฑุงูุช ูุณุช ูุนุงููุงุช

```http
GET /api/demo/trades/?status=open
Authorization: Bearer <token>
```

**Query Parameters:**
- `status`: `all`, `open`, `closed` (ูพุดโูุฑุถ: `all`)

**Response:**
```json
{
  "success": true,
  "trades": [
    {
      "id": 1,
      "symbol": "XAU/USD",
      "trade_type": "buy",
      "volume": 0.01,
      "open_price": 2050.25,
      "current_price": 2052.50,
      "stop_loss": 2040.0,
      "take_profit": 2060.0,
      "profit": 2.25,
      "commission": 0.07,
      "status": "open",
      "opened_at": "2025-01-15T10:30:00Z"
    }
  ],
  "count": 1
}
```

### 4. ุจุณุชู ูุนุงููู

```http
POST /api/demo/trades/{trade_id}/close/
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "message": "ูุนุงููู ุจุง ููููุช ุจุณุชู ุดุฏ",
  "trade": {
    "id": 1,
    "close_price": 2052.50,
    "profit": 2.25,
    "close_reason": "ุจุณุชู ุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ"
  },
  "account": {
    "balance": 10002.25,
    "equity": 10002.25,
    "margin": 0.0,
    "free_margin": 10002.25
  }
}
```

### 5. ุจุงุฒูุดุงู ุญุณุงุจ ุฏูู

```http
POST /api/demo/account/
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "message": "ุญุณุงุจ ุฏูู ุจุง ููููุช ุจุงุฒูุดุงู ุดุฏ",
  "account": {
    "balance": 10000.0,
    "equity": 10000.0,
    "margin": 0.0,
    "free_margin": 10000.0,
    "profit": 0.0
  }
}
```

## ๐ ูุญูู ฺฉุงุฑ

### 1. ุจุงุฒ ฺฉุฑุฏู ูุนุงููู

1. ฺฉุงุฑุจุฑ ุฏุฑุฎูุงุณุช ุจุงุฒ ฺฉุฑุฏู ูุนุงููู ูโุฏูุฏ
2. ุณุณุชู ููุช ูุญุธูโุง ุฑุง ุงุฒ Twelve Data ุฏุฑุงูุช ูโฺฉูุฏ
3. ูุงุฑุฌู ููุฑุฏ ูุงุฒ ูุญุงุณุจู ูโุดูุฏ
4. ุจุฑุฑุณ ููุฌูุฏ ฺฉุงู
5. ูุนุงููู ุฏุฑ `DemoTrade` ุซุจุช ูโุดูุฏ
6. ฺฉ `LiveTrade` ูู ุจุฑุง ููุงุด ุฏุฑ ุณุณุชู ุงุฌุงุฏ ูโุดูุฏ
7. ุญุณุงุจ ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ

### 2. ุจูโุฑูุฒุฑุณุงู ููุชโูุง

Celery Beat ูุฑ 10 ุซุงูู:
1. ุชูุงู ูุนุงููุงุช ุจุงุฒ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ
2. ููุช ูุญุธูโุง ุฑุง ุงุฒ Twelve Data ูโฺฏุฑุฏ
3. ููุช ูุฑ ูุนุงููู ุฑุง ุจูโุฑูุฒุฑุณุงู ูโฺฉูุฏ
4. ุณูุฏ/ุฒุงู ุฑุง ูุญุงุณุจู ูโฺฉูุฏ
5. Stop Loss ู Take Profit ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ
6. ุงฺฏุฑ SL/TP ูุนุงู ุดุฏุ ูุนุงููู ุฑุง ูโุจูุฏุฏ
7. Equity ุญุณุงุจ ุฑุง ุจูโุฑูุฒุฑุณุงู ูโฺฉูุฏ

### 3. ุจุณุชู ูุนุงููู

- **ุฏุณุช**: ฺฉุงุฑุจุฑ ูโุชูุงูุฏ ูุนุงููู ุฑุง ุจุจูุฏุฏ
- **ุฎูุฏฺฉุงุฑ**: ุงฺฏุฑ Stop Loss ุง Take Profit ูุนุงู ุดูุฏ
- **ูุญุงุณุจู ุณูุฏ/ุฒุงู**: ุจุฑ ุงุณุงุณ ููุช ุจุณุชู ุดุฏู
- **ุจูโุฑูุฒุฑุณุงู ููุฌูุฏ**: ุณูุฏ/ุฒุงู ุจู ููุฌูุฏ ุงุถุงูู ูโุดูุฏ

## ๐ ูุญุงุณุจุงุช

### ูุงุฑุฌู

```python
margin = (volume * price * 100) / leverage
```

ูุซุงู:
- ุญุฌู: 0.01 ูุงุช
- ููุช: 2050 USD
- ุงูุฑู: 100
- ูุงุฑุฌู = (0.01 * 2050 * 100) / 100 = 20.5 USD

### ุณูุฏ/ุฒุงู

**ุจุฑุง ุฎุฑุฏ (Buy):**
```python
profit = (current_price - open_price) * volume * 100 - commission
```

**ุจุฑุง ูุฑูุด (Sell):**
```python
profit = (open_price - current_price) * volume * 100 - commission
```

### Equity

```python
equity = balance + total_profit_from_open_trades
free_margin = equity - margin_used
```

## ๐ง ุชูุธูุงุช

### ุชุบุฑ ูุงุตูู ุจูโุฑูุฒุฑุณุงู ููุชโูุง

ุฏุฑ `backend/config/settings.py`:

```python
CELERY_BEAT_SCHEDULE = {
    'update-demo-trades-prices': {
        'task': 'api.tasks.update_demo_trades_prices_task',
        'schedule': 5.0,  # ูุฑ 5 ุซุงูู (ุจู ุฌุง 10)
    },
}
```

**ุชูุฌู**: ฺฉู ฺฉุฑุฏู ุงู ููุฏุงุฑ ููฺฉู ุงุณุช ุจุงุนุซ ุงูุฒุงุด ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุจู Twelve Data ุดูุฏ.

### ุชุบุฑ ููุฌูุฏ ุงููู

ุฏุฑ `backend/core/models.py`:

```python
class DemoAccount(models.Model):
    balance = models.DecimalField(
        max_digits=12, 
        decimal_places=2, 
        default=50000.0,  # ุจู ุฌุง 10000.0
        ...
    )
```

## โ๏ธ ูุญุฏูุฏุชโูุง

1. **Twelve Data API Limits**: 
   - Free plan: 800 requests/day
   - Starter plan: 8,000 requests/day
   - Professional: 100,000 requests/day

2. **ููุชโูุง ูุญุธูโุง**: 
   - ุจุง ุชูุฌู ุจู rate limitingุ ููฺฉู ุงุณุช ุชุงุฎุฑ ฺฉู ุฏุงุดุชู ุจุงุดุฏ
   - ุจุฑุง ุงุณุชูุงุฏู productionุ ุชูุตู ูโุดูุฏ ุงุฒ plan ูพูู ุงุณุชูุงุฏู ฺฉูุฏ

3. **ุฏูุช ููุชโูุง**: 
   - ููุชโูุง ุงุฒ Twelve Data ุฏุฑุงูุช ูโุดููุฏ
   - ููฺฉู ุงุณุช ุจุง ููุชโูุง ุจุฑูฺฉุฑ ูุงูุน ฺฉู ุชูุงูุช ุฏุงุดุชู ุจุงุดุฏ

## ๐ ุงููุช

- ุชูุงู endpoints ูุงุฒ ุจู authentication ุฏุงุฑูุฏ
- ูุฑ ฺฉุงุฑุจุฑ ููุท ูโุชูุงูุฏ ูุนุงููุงุช ุฎูุฏ ุฑุง ุจุจูุฏ ู ูุฏุฑุช ฺฉูุฏ
- ุญุณุงุจโูุง ุฏูู ุฌุฏุง ุงุฒ ฺฉุฏฺฏุฑ ูุณุชูุฏ

## ๐ ูฺฉุงุช ููู

1. **ูุจู ุงุฒ ุงุณุชูุงุฏู production**:
   - API Key ุฑุง ุฏุฑ `.env` ูุฑุงุฑ ุฏูุฏ
   - Celery Beat ุฑุง ุงุฌุฑุง ฺฉูุฏ
   - Rate limiting ุฑุง ุจุฑุฑุณ ฺฉูุฏ

2. **ุจุฑุง ุงุชุตุงู ุจู ุจุฑูฺฉุฑ ูุงูุน**:
   - ูโุชูุงูุฏ ุงุฒ ููุงู API endpoints ุงุณุชูุงุฏู ฺฉูุฏ
   - ููุท ฺฉุงู ุงุณุช ุจู ุฌุง `DemoTrade`ุ ุงุฒ MT5 ุงุณุชูุงุฏู ฺฉูุฏ
   - ุณุณุชู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุชุดุฎุต ูโุฏูุฏ

3. **ุชุณุช**:
   - ุงุจุชุฏุง ุจุง ุญุณุงุจ ุฏูู ุชุณุช ฺฉูุฏ
   - ูุทูุฆู ุดูุฏ ฺฉู ููุชโูุง ุฏุฑุณุช ุฏุฑุงูุช ูโุดููุฏ
   - ูุนุงููุงุช ุฑุง ุจุงุฒ ู ุจุณุชู ฺฉูุฏ

## ๐ ุนุจโุงุจ

### ููุชโูุง ุจูโุฑูุฒุฑุณุงู ููโุดููุฏ

1. ุจุฑุฑุณ ฺฉูุฏ Celery Beat ุงุฌุฑุง ูโุดูุฏ:
   ```bash
   celery -A config beat --loglevel=info
   ```

2. ุจุฑุฑุณ ูุงฺฏโูุง:
   ```bash
   tail -f logs/api.log
   ```

3. ุจุฑุฑุณ API Key:
   ```bash
   echo $TWELVEDATA_API_KEY
   ```

### ุฎุทุง "ููุฌูุฏ ฺฉุงู ูุณุช"

- ููุฌูุฏ ุญุณุงุจ ุฏูู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ูุงุฑุฌู ููุฑุฏ ูุงุฒ ุฑุง ูุญุงุณุจู ฺฉูุฏ
- ูโุชูุงูุฏ ุญุณุงุจ ุฑุง ุจุงุฒูุดุงู ฺฉูุฏ

## ๐ ููุงุจุน ุจุดุชุฑ

- [Twelve Data Documentation](https://twelvedata.com/docs)
- [Celery Documentation](https://docs.celeryproject.org/)
- [Django REST Framework](https://www.django-rest-framework.org/)

